# -*- coding: utf-8 -*-
"""boston (1).ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1Wd5Up4atMlRRwz8gnuYS4Xih26zsWe2u
"""

import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns

df = pd.read_csv('HousingData.csv')
df.head()

df.info()

df.shape

df.describe()

df.isnull().sum()

df['CRIM'].fillna(df['CRIM'].median(), inplace=True)

df['CRIM'].isnull().sum()

df['ZN'].fillna(df['ZN'].median(), inplace=True)

df['INDUS'].fillna(df['INDUS'].median(), inplace=True)

df['CHAS'].fillna(df['CHAS'].median(), inplace=True)

df['AGE'].fillna(df['AGE'].median(), inplace=True)

df['LSTAT'].fillna(df['LSTAT'].median(), inplace=True)

df.isnull().sum()

corr = df.corr()

corr.style.background_gradient(cmap='coolwarm')

sns.pairplot(df)

df.columns

x = df[['CRIM', 'ZN', 'INDUS', 'CHAS', 'NOX', 'RM', 'AGE', 'DIS', 'RAD', 'TAX',
       'PTRATIO', 'B', 'LSTAT']]
x

y = df[['MEDV']]
y

from sklearn.linear_model import LinearRegression

reg = LinearRegression()

from sklearn.model_selection import train_test_split

xtrain, xtest, ytrain, ytest = train_test_split(x, y, test_size=0.2)

reg.fit(xtrain, ytrain)

ypred = reg.predict(xtest)

from sklearn.metrics import mean_squared_error

mse = mean_squared_error(ytest, ypred)
mse

from sklearn.metrics import r2_score

r2s = r2_score(ytest, ypred)
r2s

df.head()

reg.predict([[0.0273, 0.0, 7.07,0.0,0.469,6.421,78.9,4.9671,2,242,17.8,396.90,9.14]])

import pickle

pickle.dump(reg, open('model.pkl', 'wb'))

model = pickle.load(open('model.pkl', 'rb'))
print(model.predict([[0.0273, 0.0, 7.07,0.0,0.469,6.421,78.9,4.9671,2,242,17.8,396.90,9.14]]))

